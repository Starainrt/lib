!function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=4)}([,function(e,n){},function(e,n){},,function(e,n,t){function o(e){return document.querySelector(e)}t(2),t(1);var r={init:function(){this.initPage()},initPage:function(){var e=this,n=o("#login-btn"),t=o("#sno"),r=o("#sname");n.addEventListener("touchstart",function(n){var o=t.value.trim(),i=r.value.trim();e.changeLoginBtn(),e.verify(o,i,function(n){e.ajax("POST",e.s(n,"login",i,"gdutlib"),"./interface.php",function(n){switch(n.code){case-3:e.showAlert("您已经超过登录帐号限制，请稍后再登录~"),e.sendMsg("E3","beyondLogin");break;case-2:case-1:e.showAlert("您的输入有误，请检查后重新输入~"),console.log("输入或请求有误");break;case 0:e.showAlert("您输入的姓名或学号有误，请重新输入~"),console.log("姓名与学号不对应");break;case 1:console.log("登录成功"),window.location="./home.html";break;case 2:e.showAlert("很遗憾，您大学期间未借过书，无法进入『馆藏记忆』~"),console.log("借书0本");break;default:e.showAlert("出错啦~请稍后登录呗~"),e.sendMsg("E2","responseErr-201--"+n.code+n.msg)}e.changeLoginBtn()})})}),console.log("初始化页面成功")},verify:function(e,n,t){var o=this;if(/^\d{10}$/.test(e)&&/^[\u4e00-\u9fa5·•﹒]+$/.test(n)){console.log("check ok");var r="uid="+e+"&name="+n+"&cmd=login";"3"==e[3]?t&&t(r):"6"==e[3]||"5"==e[3]||"4"==e[3]?o.showConfirm("本纪念册为毕业生而设计，您不是大四毕业生，确定要继续访问吗？")?t&&t(r):o.changeLoginBtn():(o.showAlert("抱歉，本纪念册仅向在读本科生开放。"),o.changeLoginBtn())}else o.showAlert("您输入的姓名或学号格式有误，请检查后重新输入~"),o.changeLoginBtn()},changeLoginBtn:function(){var e=o("#login-btn");"login-submit login-waiting"==e.className?(e.className="login-submit",e.setAttribute("value","登录")):(e.className="login-submit login-waiting",e.setAttribute("value","登录中..."))},triggerEvent:function(e,n){var t=document.createEvent("HTMLEvents");return t.eventName=n,t.initEvent(n,!0,!0),!e.dispatchEvent(t)},showAlert:function(e){var n=document.createElement("IFRAME");n.style.display="none",n.setAttribute("src","data:text/plain,"),document.documentElement.appendChild(n),window.frames[0].window.alert(e),n.parentNode.removeChild(n)},showConfirm:function(e){var n=document.createElement("IFRAME");n.style.display="none",n.setAttribute("src","data:text/plain,"),document.documentElement.appendChild(n);var t=window.frames[0],o=t.window.confirm(e);return n.parentNode.removeChild(n),o},s:function(e,n,t,o){return e+"&secu="+AK(n+t+o)},sendMsg:function(e,n){var t=this,o="cmd=log&info="+e+":"+n;setTimeout(function(){t.ajax("POST",o,"./interface.php",function(e){switch(e.code){case 1:console.log("发送信息成功");break;default:console.log("发送信息失败,遇到未知错误--"+e.code+e.msg)}})},1e3)},ajax:function(e,n,t,o){var r=this,e=e||"GET",n=n||null,t=t||"",i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState)if(i.status>=200&&i.status<300||304==i.status){try{var e=JSON.parse(TK.de(i.responseText.slice(9)))}catch(e){return r.showAlert("系统出错,请联系管理员~"),r.sendMsg("E4","responseTextErr-"+e.message),!1}o&&o(e)}else r.showAlert("出错啦~请稍后登录呗~"),r.sendMsg("E1","requestErr-101"),location.reload()},i.onerror=function(e){r.showAlert("出错啦~请稍后登录呗~"),r.sendMsg("E1","requestErr-102"+e.message),location.reload()},i.open(e,t,!0),"POST"==e&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(n)}};document.addEventListener("DOMContentLoaded",function(e){r.init()})}]);